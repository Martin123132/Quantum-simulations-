import numpy as np

import matplotlib.pyplot as plt


# Parameters

N = 32 # Lattice size

timesteps = 200 # Time evolution

external_phases = np.linspace(0, 2*np.pi, 32) # "Flux sweep" in SQUID

noise = 0.12 # Temperature / decoherence


# MBT phase and memory fields

def mbt_init():

phase = np.random.uniform(-np.pi, np.pi, (N, N))

memory = np.zeros((N, N))

return phase, memory


def mbt_evolve(phase, memory, flux_phase, j1=0.24, j2=0.24, barrier_locs=[(N//2,0),(N//2,N-1)]):

new_phase = phase.copy()

for i in range(N):

for j in range(N):

neighbors = []

for di, dj in [(-1,0),(1,0),(0,-1),(0,1)]:

ni, nj = (i+di)%N, (j+dj)%N

# Two Josephson junctions ("barriers" with different coupling)

if (i,j) in barrier_locs and (ni,nj) in barrier_locs:

if (i,j)==barrier_locs[0] and (ni,nj)==barrier_locs[1]:

coupling = j2

phase_shift = flux_phase

elif (i,j)==barrier_locs[1] and (ni,nj)==barrier_locs[0]:

coupling = j1

phase_shift = -flux_phase

else:

coupling = 0.15

phase_shift = 0

elif (i,j) in barrier_locs or (ni,nj) in barrier_locs:

coupling = 0.15

phase_shift = 0

else:

coupling = 1.0

phase_shift = 0

delta = phase[ni, nj] - phase[i, j] + phase_shift

neighbors.append(coupling * np.sin(delta))

drift = sum(neighbors) + noise*np.random.randn()

new_phase[i,j] += 0.15 * drift

memory[i,j] = 0.96 * memory[i,j] + 0.04 * np.cos(phase[i,j])

return new_phase, memory


# Simulate SQUID response

def measure_critical_current(flux_vals):

critical = []

for ext_phase in flux_vals:

phase, memory = mbt_init()

for t in range(timesteps):

phase, memory = mbt_evolve(phase, memory, ext_phase)

# "Order parameter" = max phase coherence across junction

p1 = phase[N//2,0]

p2 = phase[N//2,N-1]

order = np.abs(np.cos(p1-p2))

critical.append(order)

return np.array(critical)


# Run

flux_vals = external_phases

critical_current = measure_critical_current(flux_vals)


# Visualize: Final phase/memory and SQUID oscillation

phase, memory = mbt_init()

for t in range(timesteps):

phase, memory = mbt_evolve(phase, memory, flux_vals[8])


fig, axs = plt.subplots(1,3, figsize=(15,4))

axs[0].imshow(np.cos(phase), cmap='twilight', interpolation='nearest')

axs[0].set_title('Final MBT Phase Field (cos)')

axs[1].imshow(memory, cmap='inferno', interpolation='nearest')

axs[1].set_title('Final MBT Memory Field')

axs[2].plot(flux_vals/(2*np.pi), critical_current, label='MBT Critical Current')

axs[2].set_xlabel('Applied Phase / Flux (cycles)')

axs[2].set_ylabel('Order (SQUID response)')

axs[2].set_title('MBT “SQUID” Oscillation\n(First Principles Only)')

axs[2].legend()

plt.tight_layout()

plt.show()
